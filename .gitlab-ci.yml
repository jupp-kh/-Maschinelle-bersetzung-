# Environment variable readme
# https://docs.gitlab.com/ee/ci/variables/

# Predefined environment variables
# https://docs.gitlab.com/ee/ci/variables/predefined_variables.html

# Using docker images
# https://docs.gitlab.com/ee/ci/docker/using_docker_images.html

# .gitlab-ci.yml reference
# https://docs.gitlab.com/ee/ci/yaml/

# Container registry reference (authenticating, etc.)
# https://gitlab.com/help/user/packages/container_registry/index

stages:
  - test
  - report



unittest-test:
  image: tmaier/docker-compose

  services:
    - docker:dind

  stage: test

  before_script:
    - docker-compose build --no-cache

  script:
    - docker-compose run ci-series python -m unittest discover -s ./tests


discord-webhook:
  image: tmaier/docker-compose

  services:
    - docker:dind

  stage: report 

  before_script:
    - docker-compose build --no-cache

  script:
    - ./compile_to_discord.sh "$CI_COMMIT_SHA" "$DISCORD_WEBHOOK"